<!DOCTYPE html>
<html lang=en>
<head>
	<title>Create a PDF from an HTML page in C# · Richard JE Cooke</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="HandheldFriendly" content="True">
	<meta name="viewport" content="width=device-width, initial-scale=1"> <!-- make page size responsive -->

	<link rel="shortcut icon" href="/_media/img/logo.png">
	<!-- Fonts -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Comfortaa&family=Mulish&family=Ubuntu+Mono&display=swap" rel="stylesheet">

	<!-- CSS -->
	<link rel="stylesheet" href="/_media/css/main.css">
	<link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">

	<!--
	TODO
	<meta name="description" content="Contents  1. Introduction 2. The final product 3. CSound &amp;amp; Cabbage 4. Pure Data      1. Introduction   This article describes the creation of a prepared piano created digitally and performed in">
	<meta name="keywords" content="pure data,music">
	<meta property="og:type" content="article">
	<meta property="og:title" content="A prepared digital piano in Pure Data">
	<meta property="og:url" content="https://richardcooke.info/en/2019/prepared-digital-piano-in-pure-data/index.html">
	<meta property="og:site_name" content="Richard JE Cooke">
	<meta property="og:description" content="Contents  1. Introduction 2. The final product 3. CSound &amp;amp; Cabbage 4. Pure Data      1. Introduction   This article describes the creation of a prepared piano created digitally and performed in">
	<meta property="og:locale" content="en">
	<meta property="og:image" content="https://richardcooke.info/en/2019/prepared-digital-piano-in-pure-data/1.png">
	<meta property="og:updated_time" content="2019-06-19T13:33:55.888Z">
	<meta name="twitter:card" content="summary">
	<meta name="twitter:title" content="A prepared digital piano in Pure Data">
	<meta name="twitter:description" content="Contents  1. Introduction 2. The final product 3. CSound &amp;amp; Cabbage 4. Pure Data      1. Introduction   This article describes the creation of a prepared piano created digitally and performed in">
	<meta name="twitter:image" content="https://richardcooke.info/en/2019/prepared-digital-piano-in-pure-data/1.png">
	-->

	<!-- rss -->
	<!-- TODO -->

</head>
<!-- avoid flash of unstyled content -->
<body onload="document.body.style.visibility=`visible`;">
<script>document.body.style.visibility=`hidden`;</script><div class="vspacer"></div>
<div class="border_bottom shadow">
	<div class="center_children">
		<div class="gutters ">
			<div>
				<a href="/" class="no_link_styling title_container">
					<img src="/_media/img/logo.png" width="40rem" height="40rem"  class="white_image"></img>
					<h1 class="title">Richard JE Cooke</h1>
				</a>
			</div>
			<div class="flex">
				<div class="hspacer">
					<a href="/articles">Articles</a>
				</div>
				<div class="hspacer">
					<a href="/apps">Apps</a>
				</div>
				<div class="hspacer">
					<a href="/music">Music</a>
				</div>
				<div class="hspacer">
					<a href="/cv">C.V.</a>
				</div>
				<div>
					<a href="/feed.xml">RSS</a>
				</div>
			</div>
		</div>
	</div>
	<div class="vspacer"></div>
</div>
<div class="vspacer"></div>
<div class="full_column post_container">
	<h2 class="post_title">Create a PDF from an HTML page in C#</h2>
	<span class="post_date">3 June 2015</span>
	<p>There are lots of libraries in .NET to create PDFs. We chose because TuesPechkin because it creates PDFs from HTML, and HTML is easy to make and has a flexible layout - so containers expand to fit content on the page.</p>
<h2>Add TuesPechkin to your project</h2>
<p>Use Nuget to add TuesPechkin and either TuesPechkin.Wkhtmltox.Win64 or 32. Note that adding these unmanaged 64 or 32 bit DLLs mean your application is no longer machine agnostic - you now <strong>must</strong> deploy to a 64 or 32 bit server. (Ensure you have installed VC runtime on any server you deploy to: https://www.microsoft.com/en-us/download/confirmation.aspx?id=40784)</p>
<h2>Make some PDF templates</h2>
<p>Add some .html files to your App_Data folder. Use some special string of letters like %% as markers for fields you will replace in code:</p>
<pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>en<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>utf-8<span class="token punctuation">'</span></span> <span class="token punctuation">/></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>%%Title%%<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>description<span class="token punctuation">'</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>%%Title%%<span class="token punctuation">'</span></span> <span class="token punctuation">/></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>author<span class="token punctuation">'</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>ECCR<span class="token punctuation">'</span></span> <span class="token punctuation">/></span></span><br>    %%Style%%<br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><br>    %%DraftStamp%%<br>    %%Header%%<br>    %%Admission%%<br>    %%IcdCodes%%<br>    %%History%%<br>    %%Investigation%%<br>    %%Future%%<br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>
<p>In your stylesheet you can use most modern CSS, such as web fonts. I used tables instead of flexbox and Bootstrap though, the latter didn't seem to convert properly:</p>
<pre class="language-css"><code class="language-css">    &lt;style><br>        <span class="token atrule"><span class="token rule">@font-face</span></span><br>        <span class="token punctuation">{</span><br>            <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">'Barcode'</span><span class="token punctuation">;</span><br>            <span class="token property">src</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>../Fonts/fre3of9x.ttf<span class="token punctuation">)</span></span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token atrule"><span class="token rule">@font-face</span></span><br>        <span class="token punctuation">{</span><br>            <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">'RobotoLight'</span><span class="token punctuation">;</span><br>            <span class="token property">src</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>../Fonts/Roboto-Light.ttf<span class="token punctuation">)</span></span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token selector">.barcode</span><br>        <span class="token punctuation">{</span><br>            <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">'Barcode'</span><span class="token punctuation">;</span><br>            <span class="token property">font-size</span><span class="token punctuation">:</span> 36pt<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token selector">html</span><br>        <span class="token punctuation">{</span><br>            <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">'RobotoLight'</span><span class="token punctuation">;</span><br>            <span class="token property">font-size</span><span class="token punctuation">:</span> 10pt<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token selector">table</span><br>        <span class="token punctuation">{</span><br>            <span class="token property">border-collapse</span><span class="token punctuation">:</span> collapse<span class="token punctuation">;</span><br>            <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token selector">td</span><br>        <span class="token punctuation">{</span><br>            <span class="token property">padding</span><span class="token punctuation">:</span> 2px<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span></code></pre>
<h2>Load the root template and replace all placeholders</h2>
<p>Open the main html file, e.g. <em>report.html</em>, and then simple do string replacement of all special fields you added.  Where a field refers to another html template then load that file and replace its fields, and so on. Don't forget to HtmlEncode() your data so it doesn't break the html tags.</p>
<pre class="language-csharp"><code class="language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">GetFuture</span><span class="token punctuation">(</span><span class="token class-name">PatientVisitConsultation</span> data<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> imageFolder<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> pdfTemplatesFolder<span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>    <span class="token class-name"><span class="token keyword">var</span></span> html <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">ReadAllText</span><span class="token punctuation">(</span>pdfTemplatesFolder <span class="token operator">+</span> <span class="token string">"Future.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>Consultation<span class="token punctuation">.</span>Administration<span class="token punctuation">.</span>FormTypeId <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><br>        html <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"%%FutureHeader%%"</span><span class="token punctuation">,</span> WebUtility<span class="token punctuation">.</span><span class="token function">HtmlEncode</span><span class="token punctuation">(</span><span class="token string">"POST-MORTEM REQUIREMENTS"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">else</span><br>        html <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"%%FutureHeader%%"</span><span class="token punctuation">,</span> WebUtility<span class="token punctuation">.</span><span class="token function">HtmlEncode</span><span class="token punctuation">(</span><span class="token string">"FUTURE MANAGEMENT, OUTSTANDING INVESTIGATIONS, AND DESIRED OUTCOME"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    html <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"%%FutureText%%"</span><span class="token punctuation">,</span> _futureBuilder<span class="token punctuation">.</span><span class="token function">GetText</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> html<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>Save the html to a single file (or two if you want more pages):</p>
<pre class="language-csharp"><code class="language-csharp">File<span class="token punctuation">.</span><span class="token function">WriteAllText</span><span class="token punctuation">(</span>pdfFolder <span class="token operator">+</span> filenameWithoutExtension <span class="token operator">+</span> <span class="token string">"Page2.html"</span><span class="token punctuation">,</span> html<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3>Warning - don't use opacity</h3>
<p>It increased my final PDF file size from 30kb to 350kb.</p>
<h2>Convert the html pages to a PDF</h2>
<p>Create a singleton instance of TuesPechkin in your IoC container like this:</p>
<pre class="language-csharp"><code class="language-csharp"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token class-name">IConverter</span> _pdfConverter <span class="token operator">=</span><br>	<span class="token keyword">new</span> <span class="token constructor-invocation class-name">ThreadSafeConverter</span><span class="token punctuation">(</span><br>		<span class="token keyword">new</span> <span class="token constructor-invocation class-name">RemotingToolset<span class="token punctuation">&lt;</span>PdfToolset<span class="token punctuation">></span></span><span class="token punctuation">(</span><br>			<span class="token keyword">new</span> <span class="token constructor-invocation class-name">Win64EmbeddedDeployment</span><span class="token punctuation">(</span><br>			    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">TempFolderDeployment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Then convert the html to PDF like this:</p>
<pre class="language-csharp"><code class="language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">CreatePdfFromHtmlPage</span><span class="token punctuation">(</span><span class="token class-name">PatientVisitConsultation</span> data<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> pdfFolder<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> filenameWithoutExtension<span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>    <span class="token class-name"><span class="token keyword">var</span></span> document <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HtmlToPdfDocument</span><br>    <span class="token punctuation">{</span><br>        GlobalSettings <span class="token operator">=</span><br>        <span class="token punctuation">{</span><br>            ProduceOutline <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>            DocumentTitle <span class="token operator">=</span> filenameWithoutExtension<span class="token punctuation">,</span><br>            PaperSize <span class="token operator">=</span> PaperKind<span class="token punctuation">.</span>A4<span class="token punctuation">,</span><br>            Margins <span class="token operator">=</span><br>            <span class="token punctuation">{</span><br>                All <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span><br>                Unit <span class="token operator">=</span> Unit<span class="token punctuation">.</span>Centimeters<br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        Objects <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>Consultation<span class="token punctuation">.</span>Administration<span class="token punctuation">.</span>FormTypeId <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><br>    <span class="token punctuation">{</span><br>        document<span class="token punctuation">.</span>Objects<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ObjectSettings</span> <span class="token punctuation">{</span> PageUrl <span class="token operator">=</span> pdfFolder <span class="token operator">+</span> filenameWithoutExtension <span class="token operator">+</span> <span class="token string">"Page1.html"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        document<span class="token punctuation">.</span>Objects<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ObjectSettings</span> <span class="token punctuation">{</span> PageUrl <span class="token operator">=</span> pdfFolder <span class="token operator">+</span> filenameWithoutExtension <span class="token operator">+</span> <span class="token string">"Page2.html"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">else</span> document<span class="token punctuation">.</span>Objects<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ObjectSettings</span> <span class="token punctuation">{</span> PageUrl <span class="token operator">=</span> pdfFolder <span class="token operator">+</span> filenameWithoutExtension <span class="token operator">+</span> <span class="token string">".html"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> result <span class="token operator">=</span> _pdfConverter<span class="token punctuation">.</span><span class="token function">Convert</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    File<span class="token punctuation">.</span><span class="token function">WriteAllBytes</span><span class="token punctuation">(</span>pdfFolder <span class="token operator">+</span> filenameWithoutExtension <span class="token operator">+</span> <span class="token string">".pdf"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<h2>Return the PDF in a web service</h2>
<p>If you want to send the PDF to a browser then use this method:</p>
<pre class="language-csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"GetPdfForConsultation"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><br><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpPost</span></span><span class="token punctuation">]</span><br><span class="token keyword">public</span> <span class="token return-type class-name">IHttpActionResult</span> <span class="token function">GetPdfForConsultation</span><span class="token punctuation">(</span><span class="token class-name">HttpRequestMessage</span> request<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">long</span></span> consultationId<span class="token punctuation">)</span><br><span class="token punctuation">{</span><br>    <span class="token class-name"><span class="token keyword">var</span></span> token <span class="token operator">=</span> request<span class="token punctuation">.</span>Content<span class="token punctuation">.</span><span class="token function">ReadAsStringAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//"token=243lblahblahblah"</span><br>    <span class="token class-name"><span class="token keyword">var</span></span> hisSignInModel <span class="token operator">=</span> _tokenManager<span class="token punctuation">.</span><span class="token function">ValidateToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    _userManager<span class="token punctuation">.</span><span class="token function">ThrowExceptionIfUserDoesNotHavePermission</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> PermissionName<span class="token punctuation">.</span>ViewDischargeSummaries<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token class-name"><span class="token keyword">var</span></span> pdfFolder <span class="token operator">=</span> HostingEnvironment<span class="token punctuation">.</span><span class="token function">MapPath</span><span class="token punctuation">(</span><span class="token string">@"~/"</span> <span class="token operator">+</span> Core<span class="token punctuation">.</span>Configuration<span class="token punctuation">.</span>DischargePdfFolder<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token class-name"><span class="token keyword">var</span></span> imageFolder <span class="token operator">=</span> HostingEnvironment<span class="token punctuation">.</span><span class="token function">MapPath</span><span class="token punctuation">(</span><span class="token string">@"~/"</span> <span class="token operator">+</span> Core<span class="token punctuation">.</span>Configuration<span class="token punctuation">.</span>ImageFolder<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token class-name"><span class="token keyword">var</span></span> pdfTemplatesFolder <span class="token operator">=</span> HostingEnvironment<span class="token punctuation">.</span><span class="token function">MapPath</span><span class="token punctuation">(</span><span class="token string">@"~/"</span> <span class="token operator">+</span> Core<span class="token punctuation">.</span>Configuration<span class="token punctuation">.</span>PdfTemplatesFolder<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    _pdfManager<span class="token punctuation">.</span><span class="token function">DeleteOldPdfs</span><span class="token punctuation">(</span>pdfFolder<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token class-name"><span class="token keyword">var</span></span> filename <span class="token operator">=</span> _pdfManager<span class="token punctuation">.</span><span class="token function">CreateDischargePdfAndReturnFilename</span><span class="token punctuation">(</span>consultationId<span class="token punctuation">,</span> pdfFolder<span class="token punctuation">,</span> hisSignInModel<span class="token punctuation">,</span> imageFolder<span class="token punctuation">,</span> pdfTemplatesFolder<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">//return pdf</span><br>    <span class="token class-name"><span class="token keyword">var</span></span> path <span class="token operator">=</span> pdfFolder <span class="token operator">+</span> filename<span class="token punctuation">;</span><br>    <span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> fileBytes <span class="token operator">=</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>File<span class="token punctuation">.</span><span class="token function">ReadAllBytes</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HttpResponseMessage</span><span class="token punctuation">(</span>HttpStatusCode<span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    response<span class="token punctuation">.</span>Content <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ByteArrayContent</span><span class="token punctuation">(</span>fileBytes<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    response<span class="token punctuation">.</span>Content<span class="token punctuation">.</span>Headers<span class="token punctuation">.</span>ContentDisposition <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ContentDispositionHeaderValue</span><span class="token punctuation">(</span><span class="token string">"inline"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//'attachment' will download instead</span><br>    response<span class="token punctuation">.</span>Content<span class="token punctuation">.</span>Headers<span class="token punctuation">.</span>ContentDisposition<span class="token punctuation">.</span>FileName <span class="token operator">=</span> filename<span class="token punctuation">;</span><br>    response<span class="token punctuation">.</span>Content<span class="token punctuation">.</span>Headers<span class="token punctuation">.</span>ContentType <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span><span class="token string">"application/pdf"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> <span class="token function">ResponseMessage</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>

</div>
<div class="vspacer"></div>
<div class="vspacer"></div>
</body>
</html>